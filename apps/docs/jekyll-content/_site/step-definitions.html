<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Step Definitions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/stylesheets/pygments/TomorrowNightEightiesStyle.css" rel="stylesheet">
    <link href="/stylesheets/bootstrap.css" rel="stylesheet">
    <link href="/stylesheets/styles.css" rel="stylesheet">

    <link rel="shortcut icon" href="/favicon.ico">
  </head>

  <body>
    <div class="community-nav ">
      <nav role='nav'>
        <a href='/' class="mark" alt='Cucumber' title='cukes.info'></a>
        <a href='/platforms' class="active">Docs</a>
        <a href='/blog'>Blog</a>
        <a href='/school'>School</a>
        <a href='/training'>Training</a>
        <a href='https://cucumber.pro'>Cucumber Pro</a>
        <a href='/support'>Support</a>
      </nav>
    </div>

    <div class="navbar navbar-inverse navbar-static-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>

          <div class="nav-collapse collapse">
            <ul class="nav">
              
                
                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Install <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                      
                        
                          <li><a href="/platforms.html">Platforms</a></li>
                        
                      
                        
                          <li class="divider"></li>
                        
                      
                        
                          <li><a href="/install-cucumber-jvm.html">Install Cucumber-JVM</a></li>
                        
                      
                        
                          <li><a href="/install-cucumber-ruby.html">Install Cucumber-Ruby</a></li>
                        
                      
                        
                          <li><a href="/install-cucumber-rails.html">Install Cucumber-Rails</a></li>
                        
                      
                        
                          <li><a href="/install-cucumber-js.html">Install Cucumber-JavaScript</a></li>
                        
                      
                    </ul>
                  </li>
                
              
                
                  
                  
                  <li class="">
                    <a href="/running.html">Running</a>
                  </li>
                
              
                
                  
                  
                  <li class="">
                    <a href="/gherkin.html">Gherkin</a>
                  </li>
                
              
                
                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                      
                        
                          <li><a href="/api-overview.html">API Overview</a></li>
                        
                      
                        
                          <li><a href="/glue-code.html">Glue Code</a></li>
                        
                      
                        
                          <li><a href="/step-definitions.html">Step Definitions</a></li>
                        
                      
                        
                          <li><a href="/hooks.html">Hooks</a></li>
                        
                      
                        
                          <li><a href="/reports.html">Reports</a></li>
                        
                      
                        
                          <li class="divider"></li>
                          <li class="nav-header">Cucumber-JVM</li>
                        
                      
                        
                          <li><a href="/dependency-injection.html">Dependency Injection</a></li>
                        
                      
                    </ul>
                  </li>
                
              
                
                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Learn more <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                      
                        
                          <li><a href="/browser-automation.html">Browser Automation</a></li>
                        
                      
                        
                          <li><a href="/reports.html">Reports</a></li>
                        
                      
                        
                          <li><a href="/databases.html">Databases</a></li>
                        
                      
                    </ul>
                  </li>
                
              
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="span8">
         <h1 id="step_definitions">Step Definitions</h1>

<p><em>TODO</em> Migrate docs from https://github.com/cucumber/cucumber/wiki/Step-Definitions, especially states (successful, undefined etc.)</p>

<p>When Cucumber executes a <a href="/gherkin.html#steps">Step</a> in a <a href="/gherkin.html#scenario">Scenario</a> it will look for a matching <em>Step Definition</em> to execute.</p>

<p>A Step Definition is a small piece of <em>code</em> with a <em>pattern</em> attached to it. The pattern is used to link the step definition to all the matching <a href="/gherkin.html#steps">Steps</a>, and the <em>code</em> is what Cucumber will execute when it sees a Gherkin Step.</p>

<p>Step Definitions sources must be placed in a file where Cucumber can find them. The location depends on what Cucumber implementation you are using. See <a href="/glue-code.html">Glue Code</a> for details.</p>

<p>To understand how Step Definitions work, consider the following Scenario:</p>
<div class='highlight'><pre><code class='gherkin'><span class='k'>Scenario:</span><span class='nf'> Some cukes</span>
<span class='k'>  Given </span><span class='nf'>I have </span><span class='s'>48</span><span class='nf'> cukes in my belly</span>
</code></pre></div>
<p>The <code>I have 48 cukes in my belly</code> part of the step (the text following the <code>Given</code> keyword) will match the Step Definition below.</p>
<ul class='nav nav-tabs'>
  <li><a class='java' data-toggle='tab' href='#defs-java'><div>&nbsp;</div></a></li>
  <li><a class='ruby' data-toggle='tab' href='#defs-ruby'><div>&nbsp;</div></a></li>
  <li><a class='groovy' data-toggle='tab' href='#defs-groovy'><div>&nbsp;</div></a></li>
  <li><a class='js' data-toggle='tab' href='#defs-js'><div>&nbsp;</div></a></li>
  <li><a class='clojure' data-toggle='tab' href='#defs-clojure'><div>&nbsp;</div></a></li>
  <li><a class='cplusplus' data-toggle='tab' href='#defs-cplusplus'><div>&nbsp;</div></a></li>
  <li><a class='lua' data-toggle='tab' href='#defs-lua'><div>&nbsp;</div></a></li>
  <li><a class='python' data-toggle='tab' href='#defs-python'><div>&nbsp;</div></a></li>
  <li><a class='scala' data-toggle='tab' href='#defs-scala'><div>&nbsp;</div></a></li>
  <li><a class='csharp' data-toggle='tab' href='#defs-csharp'><div>&nbsp;</div></a></li>
  <li><a class='fsharp' data-toggle='tab' href='#defs-fsharp'><div>&nbsp;</div></a></li>
</ul><div class='tab-content'>
  <div class='tab-pane' id='defs-java'>

<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;I have (\\d+) cukes in my belly&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>I_have_cukes_in_my_belly</span><span class='o'>(</span><span class='kt'>int</span> <span class='n'>cukes</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Do something with the cukes</span>
<span class='o'>}</span>
</code></pre></div>


<p>
Lists can also be specified:
</p>


<div class='highlight'><pre><code class='gherkin'><span class='k'>Given </span><span class='nf'>I am available on &quot;</span><span class='s'>Tuesday,Friday,Sunday</span><span class='nf'>&quot;</span>
</code></pre></div>



<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;I am available on \&quot;(.+)\&quot;&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>I_am_available_on</span><span class='o'>(</span><span class='n'>List</span><span class='o'>&lt;</span><span class='n'>String</span><span class='o'>&gt;</span> <span class='n'>days</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Do something with the days</span>
<span class='o'>}</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-ruby'>

<div class='highlight'><pre><code class='ruby'><span class='no'>Given</span><span class='p'>(</span><span class='sr'>/I have (\d+) cukes in my belly/</span><span class='p'>)</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>cukes</span><span class='o'>|</span>
  <span class='c1'># Do something with the cukes</span>
<span class='k'>end</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-groovy'>

<div class='highlight'><pre><code class='groovy'><span class='n'>Given</span><span class='o'>(~</span><span class='s1'>&#39;^I have (\\d+) cukes in my belly&#39;</span><span class='o'>)</span> <span class='o'>{</span> <span class='kt'>int</span> <span class='n'>cukes</span> <span class='o'>-&gt;</span>
    <span class='c1'>// Do something with the cukes</span>
<span class='o'>}</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-js'>

<div class='highlight'><pre><code class='js'><span class='nx'>Given</span><span class='p'>(</span><span class='sr'>/^I have (\d+) cukes in my belly$/</span><span class='p'>,</span> <span class='kd'>function</span> <span class='p'>(</span><span class='nx'>cukes</span><span class='p'>)</span> <span class='p'>{</span>
    <span class='c1'>// Do something with the cukes</span>
<span class='p'>});</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-clojure'>

<div class='highlight'><pre><code class='clojure'><span class='p'>(</span><span class='nf'>Given</span> <span class='o'>#</span><span class='s'>&quot;^I have (\d+) cukes in my belly$&quot;</span> <span class='p'>[</span><span class='nv'>cukes</span><span class='p'>]</span>
  <span class='p'>(</span><span class='nf'>eat</span> <span class='p'>(</span><span class='nf'>Integer.</span> <span class='nv'>cukes</span><span class='p'>)))</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-cplusplus'>

<div class='highlight'><pre><code class='cpp'><span class='n'>GIVEN</span><span class='p'>(</span><span class='s'>&quot;^I have (</span><span class='se'>\\</span><span class='s'>d+) cukes in my belly$&quot;</span><span class='p'>)</span> <span class='p'>{</span>
    <span class='n'>REGEX_PARAM</span><span class='p'>(</span><span class='kt'>int</span><span class='p'>,</span> <span class='n'>cukes</span><span class='p'>);</span>
    <span class='n'>USING_CONTEXT</span><span class='p'>(</span><span class='n'>MyAppCtx</span><span class='p'>,</span> <span class='n'>context</span><span class='p'>);</span>
    <span class='c1'>// Do something with the cukes</span>
<span class='p'>}</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-csharp'>

<div class='highlight'><pre><code class='csharp'><span class='na'>[When(@&quot;^I have (\d+) cukes in my belly$&quot;)]</span>
<span class='k'>public</span> <span class='k'>void</span> <span class='nf'>CukesInTheBelly</span><span class='p'>(</span><span class='kt'>int</span> <span class='n'>cukes</span><span class='p'>)</span>
<span class='p'>{</span>
    <span class='c1'>// Do something with the cukes</span>
<span class='p'>}</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-fsharp'>

<div class='highlight'><pre><code class='fsharp'><span class='k'>let</span> <span class='o'>[&lt;</span><span class='n'>Given</span><span class='o'>&gt;]</span> <span class='o'>``^</span><span class='n'>I</span> <span class='n'>have</span> <span class='o'>(</span><span class='err'>\</span><span class='n'>d</span><span class='o'>+)</span> <span class='n'>cukes</span> <span class='k'>in</span> <span class='n'>my</span> <span class='n'>belly</span><span class='o'>$``(</span><span class='n'>cukes</span><span class='o'>:</span><span class='n'>int</span><span class='o'>)</span> <span class='o'>=</span>
  <span class='c'>(* Do something with the cukes *)</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-lua'>

<div class='highlight'><pre><code class='lua'><span class='n'>Given</span><span class='p'>(</span><span class='s2'>&quot;</span><span class='s'>^I have (%d+) cukes in my belly$&quot;</span><span class='p'>,</span> <span class='k'>function</span> <span class='p'>(</span><span class='n'>cukes</span><span class='p'>)</span>
    <span class='c1'>-- Do something with the cukes</span>
<span class='k'>end</span><span class='p'>)</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-python'>

<div class='highlight'><pre><code class='python'><span class='nd'>@Given</span><span class='p'>(</span><span class='s'>&#39;^I have (\d+) cukes in my belly$&#39;</span><span class='p'>)</span>
<span class='k'>def</span> <span class='nf'>I_have_cukes_in_my_belly</span><span class='p'>(</span><span class='bp'>self</span><span class='p'>,</span> <span class='n'>cukes</span><span class='p'>):</span>
  <span class='c'># Do something with the cukes</span>
  <span class='k'>pass</span>
</code></pre></div>

  </div>
  <div class='tab-pane' id='defs-scala'>

<div class='highlight'><pre><code class='scala'><span class='nc'>Given</span><span class='o'>(</span><span class='s'>&quot;&quot;&quot;^I have (\d+) cukes in my belly$&quot;&quot;&quot;</span><span class='o'>){</span> <span class='o'>(</span><span class='n'>cukes</span><span class='k'>:</span><span class='kt'>Int</span><span class='o'>)</span> <span class='k'>=&gt;</span>
  <span class='c1'>// Do something with the cukes</span>
<span class='o'>}</span>
</code></pre></div>

  </div>
</div>
<p>When Cucumber matches a Step against a regular expression in a Step Definition, it passes the value of all the capture groups to the Step Definition’s arguments. Capture groups are strings (even when they match digits like <code>\d+</code>). For statically typed languages, Cucumber will automatically transform those strings into the appropriate type. For dynamically typed languages, no transformation happens by default, as there is no type information.</p>

<p>Cucumber does not differentiate between <code>Given</code>, <code>When</code> and <code>Then</code>. It is up to you what you do inside the Step Definition’s body.</p>

<h2 id="doc_strings">Doc Strings</h2>

<p>Doc Strings are handy for specifying a larger piece of text. This is inspired from Python’s <a href="http://www.python.org/dev/peps/pep-0257/">Docstring</a> syntax.</p>

<p>The text should be offset by delimiters consisting of three double-quote marks on lines of their own:</p>
<div class='highlight'><pre><code class='gherkin'><span class='k'>Given </span><span class='nf'>a blog post named &quot;</span><span class='s'>Random</span><span class='nf'>&quot; with Markdown body</span>
<span class='nf'>  </span><span class='k'>&quot;&quot;&quot;</span><span class='s' />
<span class='s'>  Some Title, Eh?</span>
<span class='s'>  ==============</span>
<span class='s'>  Here is the first paragraph of my blog post. Lorem ipsum dolor sit amet,</span>
<span class='s'>  consectetur adipiscing elit.</span>
<span class='s'>  </span><span class='k'>&quot;&quot;&quot;</span><span class='nf' />
</code></pre></div>
<p>In your step definition, there’s no need to find this text and match it in your Regexp. It will automatically be passed as the last parameter in the step definition. For example:</p>
<ul class='nav nav-tabs'>
  <li><a class='java' data-toggle='tab' href='#docstrings-java'><div>&nbsp;</div></a></li>
  <li><a class='ruby' data-toggle='tab' href='#docstrings-ruby'><div>&nbsp;</div></a></li>
</ul><div class='tab-content'>
  <div class='tab-pane' id='docstrings-java'>

<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;^a blog post named \&quot;([^\&quot;]*)\&quot; with Markdown body$&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>a_blog_post_named_something_with_markdown_body</span><span class='o'>(</span><span class='n'>String</span> <span class='n'>title</span><span class='o'>,</span> <span class='n'>String</span> <span class='n'>markdown</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Save it in the database</span>
<span class='o'>}</span>
</code></pre></div>

  </div>

  <div class='tab-pane' id='docstrings-ruby'>

<div class='highlight'><pre><code class='ruby'><span class='no'>Given</span> <span class='sr'>/^a blog post named &quot;([^&quot;]*)&quot; with Markdown body$/</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>title</span><span class='p'>,</span> <span class='n'>markdown</span><span class='o'>|</span>
  <span class='no'>Post</span><span class='o'>.</span><span class='n'>create!</span><span class='p'>(</span><span class='ss'>:title</span> <span class='o'>=&gt;</span> <span class='n'>title</span><span class='p'>,</span> <span class='ss'>:body</span> <span class='o'>=&gt;</span> <span class='n'>markdown</span><span class='p'>)</span>
<span class='k'>end</span>
</code></pre></div>

  </div>
</div>
<p>Indentation of the opening <code>&quot;&quot;&quot;</code> is unimportant, although common practice is two spaces in from the enclosing step. The indentation inside the triple quotes, however, <em>is</em> significant. Each line of the string passed to the step definition’s block will be de-indented according to the opening <code>&quot;&quot;&quot;</code>. Indentation beyond the column of the opening <code>&quot;&quot;&quot;</code> will therefore be preserved.</p>

<h2 id="data_tables">Data Tables</h2>

<p>Data Tables are handy for specifying a larger piece of data:</p>
<div class='highlight'><pre><code class='gherkin'><span class='k'>Given </span><span class='nf'>the following users exist:</span>
<span class='k'>  |</span><span class='s'> name</span><span class='k'>  |</span><span class='s'> email</span><span class='k'>           |</span><span class='s'> phone</span><span class='k'> |</span><span class='nf' />
<span class='k'>  |</span><span class='s'> Aslak</span><span class='k'> |</span><span class='s'> aslak@email.com</span><span class='k'> |</span><span class='s'> 123</span><span class='k'>   |</span><span class='nf' />
<span class='k'>  |</span><span class='s'> Matt</span><span class='k'>  |</span><span class='s'> matt@email.com</span><span class='k'>  |</span><span class='s'> 234</span><span class='k'>   |</span><span class='nf' />
<span class='k'>  |</span><span class='s'> Joe</span><span class='k'>   |</span><span class='s'> joe@email.org</span><span class='k'>   |</span><span class='s'> 456</span><span class='k'>   |</span>
</code></pre></div>
<p>Just like Doc Strings, they will be passed to the Step Definition as the last argument:</p>
<ul class='nav nav-tabs'>
  <li><a class='java' data-toggle='tab' href='#datatables-java'><div>&nbsp;</div></a></li>
  <li><a class='ruby' data-toggle='tab' href='#datatables-ruby'><div>&nbsp;</div></a></li>
</ul><div class='tab-content'>
  <div class='tab-pane' id='datatables-java'>

<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;^the following users exist$&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>the_following_users_exist</span><span class='o'>(</span><span class='n'>DataTable</span> <span class='n'>users</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Save them in the database</span>
<span class='o'>}</span>
</code></pre></div>


    See the <a href='/api/cucumber/ruby/yardoc/Cucumber/Ast/Table.html'>DataTable</a>
    API docs for details about how to access data in the table.
  </div>

  <div class='tab-pane' id='datatables-ruby'>

<div class='highlight'><pre><code class='ruby'><span class='no'>Given</span> <span class='sr'>/^the following users exist$/</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>users</span><span class='o'>|</span>
  <span class='no'>User</span><span class='o'>.</span><span class='n'>create!</span><span class='p'>(</span><span class='n'>users</span><span class='o'>.</span><span class='n'>hashes</span><span class='p'>)</span>
<span class='k'>end</span>
</code></pre></div>


    See the <a href='/api/cucumber/ruby/yardoc/Cucumber/Ast/Table.html'>DataTable</a>
    API docs for details about how to access data in the table.
  </div>
</div>
<h3 id="substitution_in_scenario_outlines">Substitution in Scenario Outlines</h3>

<p>If you use a DocString or DataTable argument in steps in <a href="/gherkin.html#scenario_outlines">Scenario Outlines</a>, any <code>&lt; &gt;</code> delimited tokens will be substituted with values from the example tables. For example:</p>
<div class='highlight'><pre><code class='gherkin'><span class='k'>Scenario Outline:</span><span class='nf'> Email confirmation</span>
<span class='k'>  Given </span><span class='nf'>I have a user account with my name &quot;</span><span class='s'>Jojo Binks</span><span class='nf'>&quot;</span>
<span class='nf'>  </span><span class='k'>When </span><span class='nf'>an Admin grants me </span><span class='nv'>&lt;Role&gt;</span><span class='nf'> rights</span>
<span class='nf'>  </span><span class='k'>Then </span><span class='nf'>I should receive an email with the body:</span>
<span class='nf'>    </span><span class='k'>&quot;&quot;&quot;</span><span class='s' />
<span class='s'>    Dear Jojo Binks,</span>
<span class='s'>    You have been granted </span><span class='nv'>&lt;Role&gt;</span><span class='s'> rights.  You are </span><span class='nv'>&lt;details&gt;</span><span class='s'>. Please be responsible.</span>
<span class='s'>    -The Admins</span>
<span class='s'>    </span><span class='k'>&quot;&quot;&quot;</span><span class='nf' />
<span class='nf'>  </span><span class='k'>Examples:</span>
<span class='k'>    |</span><span class='nv'>  Role</span><span class='k'>     |</span><span class='nv'> details</span><span class='k'>                                         |</span><span class='nf' />
<span class='k'>    |</span><span class='s'>  Manager</span><span class='k'>  |</span><span class='s'> now able to manage your employee accounts</span><span class='k'>       |</span><span class='nf' />
<span class='k'>    |</span><span class='s'>  Admin</span><span class='k'>    |</span><span class='s'> able to manage any user account on the system</span><span class='k'>   |</span>
</code></pre></div>
<h3 id="data_table_diffing">Data Table diffing</h3>

<p>One very powerful feature in Cucumber is comparison of tables. You can compare a table argument to another table that you provide within your step definition. This is something you would typically do in a <code>Then</code> step, and the other table would typically be constructed programmatically from your application’s data.</p>

<p>Beware that the diffing algorithm expects your data to be column-oriented, and that the first row of both tables represents column names. If your tables don’t have some similarity in the first row you will not get very useful results. The column names must be unique for each column – and they must match.</p>

<p>Here is an example of a Data Table that we want to diff against actual results:</p>
<div class='highlight'><pre><code class='gherkin'><span class='k'>Then </span><span class='nf'>I should see the following cukes:</span>
<span class='k'>  |</span><span class='s'> Latin</span><span class='k'>           |</span><span class='s'> English</span><span class='k'>      |</span><span class='nf' />
<span class='k'>  |</span><span class='s'> Cucumis sativus</span><span class='k'> |</span><span class='s'> Cucumber</span><span class='k'>     |</span><span class='nf' />
<span class='k'>  |</span><span class='s'> Cucumis anguria</span><span class='k'> |</span><span class='s'> Burr Gherkin</span><span class='k'> |</span>
</code></pre></div>
<p>A Step Definition can diff the DataTable with data pulled out of your application, for example from a Web page or a Database:</p>
<ul class='nav nav-tabs'>
  <li><a class='java' data-toggle='tab' href='#diff-java'><div>&nbsp;</div></a></li>
  <li><a class='ruby' data-toggle='tab' href='#diff-ruby'><div>&nbsp;</div></a></li>
</ul><div class='tab-content'>
  <div class='tab-pane' id='diff-java'>

<div class='highlight'><pre><code class='java'><span class='nd'>@Then</span><span class='o'>(</span><span class='s'>&quot;^I should see the following cukes:$&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>the_following_users_exist</span><span class='o'>(</span><span class='n'>DataTable</span> <span class='n'>expectedCukesTable</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// We&#39;d typically pull this out of a database or a web page...</span>
    <span class='n'>List</span><span class='o'>&lt;</span><span class='n'>Cuke</span><span class='o'>&gt;</span> <span class='n'>actualCukes</span> <span class='o'>=</span> <span class='k'>new</span> <span class='n'>ArrayList</span><span class='o'>();</span>
    <span class='n'>actualCukes</span><span class='o'>.</span><span class='na'>add</span><span class='o'>(</span><span class='k'>new</span> <span class='n'>Cuke</span><span class='o'>(</span><span class='s'>&quot;Cucumis sativus&quot;</span><span class='o'>,</span> <span class='s'>&quot;Concombre&quot;</span><span class='o'>));</span>
    <span class='n'>actualCukes</span><span class='o'>.</span><span class='na'>add</span><span class='o'>(</span><span class='k'>new</span> <span class='n'>Cuke</span><span class='o'>(</span><span class='s'>&quot;Cucumis anguria&quot;</span><span class='o'>,</span> <span class='s'>&quot;Burr Gherkin&quot;</span><span class='o'>));</span>

    <span class='n'>expectedCukesTable</span><span class='o'>.</span><span class='na'>diff</span><span class='o'>(</span><span class='n'>actualCukes</span><span class='o'>)</span>
<span class='o'>}</span>
</code></pre></div>


    <p>
      The list passed to <code>diff</code> can be a <code>DataTable</code>, <code>List&lt;YourType&gt;</code>,
      <code>List&lt;Map&gt;</code> or a <code>List&lt;List&lt;ScalarType&gt;&gt;</code>.
    </p>
  </div>
  <div class='tab-pane' id='diff-ruby'>

<div class='highlight'><pre><code class='ruby'><span class='no'>Then</span> <span class='sr'>/^I should see the following cukes:$/</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>expected_cukes_table</span><span class='o'>|</span>
  <span class='c1'># We&#39;d typically pull this out of a database or a web page...</span>
  <span class='n'>actual_cukes</span> <span class='o'>=</span> <span class='o'>[</span>
    <span class='o'>[</span><span class='s1'>&#39;Latin&#39;</span><span class='p'>,</span> <span class='s1'>&#39;English&#39;</span><span class='o'>]</span><span class='p'>,</span>
    <span class='o'>[</span><span class='s1'>&#39;Cucumis sativus&#39;</span><span class='p'>,</span> <span class='s1'>&#39;Concombre&#39;</span><span class='o'>]</span><span class='p'>,</span>
    <span class='o'>[</span><span class='s1'>&#39;Cucumis anguria&#39;</span><span class='p'>,</span> <span class='s1'>&#39;Burr Gherkin&#39;</span><span class='o'>]</span>
  <span class='o'>]</span>

  <span class='n'>expected_cukes_table</span><span class='o'>.</span><span class='n'>diff!</span><span class='p'>(</span><span class='n'>actual_cukes</span><span class='p'>)</span>
<span class='k'>end</span>
</code></pre></div>


    <p>
      The list passed to <code>diff!</code> can be a <code>Cucumber::Ast::Table</code>,
      <code>Array</code> of <code>Map</code> or an <code>Array</code> of <code>Array</code> of <code>String</code>.
    </p>

    <p>
      If you are using [Capybara](http://jnicklas.github.com/capybara/) and you want to compare a Gherkin DataTable with a
      HTML table rendered in a Web page you can construct an Array like so:
    </p>


<div class='highlight'><pre><code class='ruby'><span class='n'>rows</span> <span class='o'>=</span> <span class='n'>find</span><span class='p'>(</span><span class='s2'>&quot;table#selector&quot;</span><span class='p'>)</span><span class='o'>.</span><span class='n'>all</span><span class='p'>(</span><span class='s1'>&#39;tr&#39;</span><span class='p'>)</span>
<span class='n'>table</span> <span class='o'>=</span> <span class='n'>rows</span><span class='o'>.</span><span class='n'>map</span> <span class='p'>{</span> <span class='o'>|</span><span class='n'>r</span><span class='o'>|</span> <span class='n'>r</span><span class='o'>.</span><span class='n'>all</span><span class='p'>(</span><span class='s1'>&#39;th,td&#39;</span><span class='p'>)</span><span class='o'>.</span><span class='n'>map</span> <span class='p'>{</span> <span class='o'>|</span><span class='n'>c</span><span class='o'>|</span> <span class='n'>c</span><span class='o'>.</span><span class='n'>text</span><span class='o'>.</span><span class='n'>strip</span> <span class='p'>}</span> <span class='p'>}</span>
<span class='n'>expected_table</span><span class='o'>.</span><span class='n'>diff!</span><span class='p'>(</span><span class='n'>table</span><span class='p'>)</span>
</code></pre></div>

  </div>
</div>
<p>If the tables are different, an exception is thrown, and the diff of the two tables are reported in the <a href="/reports.html">Report</a>.</p>

<h2 id="string_transformations">String Transformations</h2>

<p>Cucumber provides an API that lets you take control over how strings are converted to other types. This is useful especially for dynamically typed languages, but also for statically typed languages when you need more control over the transformation.</p>

<p>Let’s consider a common example - turning a string into a date:</p>
<div class='highlight'><pre><code class='gherkin'><span class='k'>Given </span><span class='nf'>today&#39;s date is &quot;</span><span class='s'>10-03-1971</span><span class='nf'>&quot;</span>
</code></pre></div>
<p>First of all, this might mean the 10th of March in some countries, and the 3rd of October in others. It’s best to be explicit about how we want this converted. We’ll try to convert it to <em>10th of March 1971</em>.</p>
<ul class='nav nav-tabs'>
  <li><a class='java' data-toggle='tab' href='#transform-java'><div>&nbsp;</div></a></li>
  <li><a class='ruby' data-toggle='tab' href='#transform-ruby'><div>&nbsp;</div></a></li>
</ul><div class='tab-content'>
  <div class='tab-pane' id='transform-java'>
    <p>
    Cucumber-JVM knows how to convert strings into various <em>scalar</em> types. A scalar type is a type that can be derived from a single
    string value. Cucumber-JVM's built-in scalar types are <em>numbers</em>, <em>enums</em>, <code>java.util.Date</code>,
    <code>java.util.Calendar</code> and arbitrary types that have a single-argument constructor that is either a
    <code>String</code> or an <code>Object</code>.
    </p>

    <p>
    Transformation to <code>java.util.Date</code> and <code>java.util.Calendar</code> will work out-of-the-box as long as the
    string value matches one of the <code>SHORT</code>, <code>MEDIUM</code>, <code>FULL</code> or <code>LONG</code> formats
    defined by <a href='http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html'><code>java.util.DateFormat</code></a>.
    </p>

    <p>
    It turns out that <code>10-03-1971</code> from our example doesn't match any of those formats, so we have to give Cucumber a hint:
    </p>


<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;today&#39;s date is \&quot;(.*)\&quot;&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>todays_date_is</span><span class='o'>(</span><span class='nd'>@Format</span><span class='o'>(</span><span class='s'>&quot;dd-MM-yyyy&quot;</span><span class='o'>)</span> <span class='n'>Date</span> <span class='n'>today</span><span class='o'>)</span> <span class='o'>{</span>
<span class='o'>}</span>
</code></pre></div>


    <p>
    Many Java programmers like to use <a href='http://joda-time.sourceforge.net/'>Joda Time</a>. Cucumber-JVM doesn't have any special support for Joda Time, but since Joda's <code>LocalDate</code> has a <code>LocalDate(Object)</code> constructor it is considered a scalar by default.
    </p>

    <p>
    However, in this case it wouldn't also know how to pass the _format_ string, so you would get an exception when Cucumber instantiates it
    with <code>new LocalDate("10-03-1971")</code>.
    </p>

    <p>
    A custom formatter gives you full control:
    </p>


<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;today&#39;s date is \&quot;(.*)\&quot;&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>todays_date_is</span><span class='o'>(</span>
  <span class='nd'>@Format</span><span class='o'>(</span><span class='s'>&quot;dd-MM-yyyy&quot;</span><span class='o'>)</span>
  <span class='nd'>@Transform</span><span class='o'>(</span><span class='n'>JodaTransformer</span><span class='o'>.</span><span class='na'>class</span><span class='o'>)</span>
  <span class='n'>LocalDate</span> <span class='n'>today</span><span class='o'>)</span> <span class='o'>{</span>
<span class='o'>}</span>
</code></pre></div>


    <p>
    The custom transformer looks like this:
    </p>


<div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kd'>class</span> <span class='nc'>JodaTransformer</span> <span class='kd'>extends</span> <span class='n'>Transformer</span><span class='o'>&lt;</span><span class='n'>LocalDate</span><span class='o'>&gt;</span> <span class='o'>{</span>
    <span class='nd'>@Override</span>
    <span class='kd'>public</span> <span class='n'>LocalDate</span> <span class='nf'>transform</span><span class='o'>(</span><span class='n'>String</span> <span class='n'>value</span><span class='o'>)</span> <span class='o'>{</span>
        <span class='n'>String</span> <span class='n'>format</span> <span class='o'>=</span> <span class='n'>getParameterInfo</span><span class='o'>().</span><span class='na'>getFormat</span><span class='o'>();</span>
        <span class='n'>DateTimeFormatter</span> <span class='n'>dateTimeFormatter</span> <span class='o'>=</span> <span class='n'>DateTimeFormat</span><span class='o'>.</span><span class='na'>forStyle</span><span class='o'>(</span><span class='n'>format</span><span class='o'>);</span>
        <span class='n'>dateTimeFormatter</span> <span class='o'>=</span> <span class='n'>dateTimeFormatter</span><span class='o'>.</span><span class='na'>withLocale</span><span class='o'>(</span><span class='n'>getLocale</span><span class='o'>());</span>
        <span class='k'>return</span> <span class='n'>dateTimeFormatter</span><span class='o'>.</span><span class='na'>parseLocalDate</span><span class='o'>(</span><span class='n'>value</span><span class='o'>);</span>
    <span class='o'>}</span>
<span class='o'>}</span>
</code></pre></div>


    <p>
    Of course, you can write transformers for anything, not just dates.
    </p>

  </div>
  <div class='tab-pane' id='transform-ruby'>
    <p>
    Let's <code>Transform</code> anything that looks like a date into an instance of <code>Date</code>:


<div class='highlight'><pre><code class='ruby'><span class='nb'>require</span> <span class='s1'>&#39;date&#39;</span>

<span class='no'>Transform</span><span class='p'>(</span><span class='sr'>/^(\d\d-\d\d-\d\d\d\d)$/</span><span class='p'>)</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>arg</span><span class='o'>|</span>
  <span class='no'>Date</span><span class='o'>.</span><span class='n'>strptime</span><span class='p'>(</span><span class='n'>arg</span><span class='p'>,</span> <span class='s1'>&#39;%d-%m-%Y&#39;</span><span class='p'>)</span>
<span class='k'>end</span>
</code></pre></div>

    </p>
  </div>
</div>
<h2 id="data_table_transformations">Data Table Transformations</h2>

<p><em>This applies to Cucumber-JVM only</em></p>

<p>Data Tables can be transformed to a <code>List</code> of various types. We’ll see how the table in the following Scenario can be transformed to different kinds of lists.</p>
<div class='highlight'><pre><code class='gherkin'><span class='k'>Scenario:</span><span class='nf'> Some vegetables</span>
<span class='k'>  Given </span><span class='nf'>I have these vegetables:</span>
<span class='k'>    |</span><span class='s'> name</span><span class='k'>     |</span><span class='s'> color</span><span class='k'> |</span><span class='nf' />
<span class='k'>    |</span><span class='s'> Cucumber</span><span class='k'> |</span><span class='s'> Green</span><span class='k'> |</span><span class='nf' />
<span class='k'>    |</span><span class='s'> Tomato</span><span class='k'>   |</span><span class='s'> Red</span><span class='k'>   |</span>
</code></pre></div>
<h3 id="list_of_yourtype">List of YourType</h3>

<p>The table can be transformed into a list of vegetables:</p>
<div class='highlight'><pre><code class='java'><span class='kd'>public</span> <span class='kd'>class</span> <span class='nc'>Vegetable</span> <span class='o'>{</span>
    <span class='kd'>public</span> <span class='n'>String</span> <span class='n'>name</span><span class='o'>;</span>
    <span class='kd'>public</span> <span class='n'>Color</span> <span class='n'>color</span><span class='o'>;</span> <span class='c1'>// Color is an enum</span>
<span class='o'>}</span>
</code></pre></div>
<p>The Step Definition:</p>
<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;I have these vegetables:&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>I_have_these_vegetables</span><span class='o'>(</span><span class='n'>List</span><span class='o'>&lt;</span><span class='n'>Vegetable</span><span class='o'>&gt;</span> <span class='n'>vegetables</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Do something with the vegetables</span>
<span class='o'>}</span>
</code></pre></div>
<p>The header row is used to name fields in the generic List type.</p>

<p><em>IMPORTANT</em>: If the generic List type (<code>Vegetable</code> in this case) is a <em>scalar</em> (i.e. it has a <code>String</code> or <code>Object</code> constructor), the header will <em>not</em> be used to name fields in the class. Instead you would get a List that has one <code>Vegetable</code> for <em>each cell</em> (6 in this case). See <a href="#list_of_scalar">List of Scalar</a> below.</p>

<h3 id="list_of_map">List of Map</h3>

<p>You can also transform a DataTable to a list of maps:</p>
<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;I have these vegetables:&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>I_have_these_vegetables</span><span class='o'>(</span><span class='n'>List</span><span class='o'>&lt;</span><span class='n'>Map</span><span class='o'>&lt;</span><span class='n'>String</span><span class='o'>,</span> <span class='n'>String</span><span class='o'>&gt;&gt;</span> <span class='n'>vegetables</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Do something with the vegetables</span>
<span class='o'>}</span>
</code></pre></div>
<p>The <code>Key</code> and <code>Value</code> generic types of the <code>Map</code> can be any kind of scalar type.</p>

<h3 id="list_of_list_of_scalar">List of List of scalar</h3>

<p>You can also convert it to a list of list scalar:</p>
<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;I have these vegetables:&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>I_have_these_vegetables</span><span class='o'>(</span><span class='n'>List</span><span class='o'>&lt;</span><span class='n'>List</span><span class='o'>&lt;</span><span class='n'>String</span><span class='o'>&gt;&gt;</span> <span class='n'>vegetables</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Do something with the vegetables</span>
<span class='o'>}</span>
</code></pre></div>
<p>This will convert it to a flattened list like this:</p>

<p><code>[[&quot;name&quot;, &quot;color&quot;], [&quot;Cucumber&quot;, &quot;Green&quot;], [&quot;Tomato&quot;, &quot;Red&quot;]]</code></p>

<p>You can also convert it to a list of scalar:</p>

<h3 id="list_of_scalar">List of scalar</h3>
<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;I have these vegetables:&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>I_have_these_vegetables</span><span class='o'>(</span><span class='n'>List</span><span class='o'>&lt;</span><span class='n'>String</span><span class='o'>&gt;</span> <span class='n'>vegetables</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Do something with the vegetables</span>
<span class='o'>}</span>
</code></pre></div>
<p>This will convert it to a flattened list like this: <code>[&quot;name&quot;, &quot;color&quot;, &quot;Cucumber&quot;, &quot;Green&quot;, &quot;Tomato&quot;, &quot;Red&quot;]</code></p>

<h3 id="map_of_scalar">Map of scalar</h3>
<div class='highlight'><pre><code class='java'><span class='nd'>@Given</span><span class='o'>(</span><span class='s'>&quot;I have these vegetables:&quot;</span><span class='o'>)</span>
<span class='kd'>public</span> <span class='kt'>void</span> <span class='nf'>I_have_these_vegetables</span><span class='o'>(</span><span class='n'>Map</span><span class='o'>&lt;</span><span class='n'>String</span><span class='o'>,</span><span class='n'>String</span><span class='o'>&gt;</span> <span class='n'>vegetables</span><span class='o'>)</span> <span class='o'>{</span>
    <span class='c1'>// Do something with the vegetables</span>
<span class='o'>}</span>
</code></pre></div>
<p>This will convert it to a map list like this: <code>{&quot;name&quot; =&gt; &quot;color&quot;, &quot;Cucumber&quot; =&gt; &quot;Green&quot;, &quot;Tomato&quot; =&gt; &quot;Red&quot;}</code></p>

<p>Note that this only works for tables with 2 columns. If you’re converting into a <code>Map</code> it is usually adviseable that the Gherkin table doesn’t have a top row naming the columns.</p>

<h2 id="faq">FAQ</h2>

<h3 id="i_want_to_scope_a_step_definition_to_a_scenario_or_feature">I want to scope a step definition to a scenario or feature</h3>

<p>TODO: Summarise info from:</p>

<ul>
<li>https://groups.google.com/d/msg/cukes/53UKauIY28o/1nrdSCWAkLMJ</li>

<li>https://github.com/cucumber/cucumber/wiki/Feature-Coupled-Step-Definitions-(Antipattern)</li>
</ul>
        </div>
      </div>
    </div>

    <footer>
      <div class="container">
        <a href="https://github.com/cucumber/website/edit/master/apps/docs/jekyll-content/step-definitions.md">Edit this page</a>
      </div>
    </footer>

    <script src="/javascripts/jquery-1.8.1.min.js"></script>
    <script src="/javascripts/bootstrap-2.3.1.min.js"></script>
    <script src="/javascripts/bootstrap-tab-memory.js"></script>
  </body>
</html>
